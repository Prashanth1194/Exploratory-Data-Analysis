"0","insurance.grid = expand.grid(age = seq(18, 64, 3), smoker = c(""no""),bmi=seq(15.96,53.1,2),sex=c(""female""))"
"0",""
"0","insurance.grid$smoker = ifelse(insurance.grid$smoker==""yes"",1,0)"
"0","insurance.grid$sex = ifelse(insurance.grid$sex==""male"",2,1)"
"0","insurance.predict = predict(fit_loess, newdata = insurance.grid)"
"0","insurance.plot.df = data.frame(insurance.grid, fit = as.vector(insurance.predict))"
"0",""
"0","insurance.plot.df$age_cat = ifelse(insurance.plot.df$age>=18 & insurance.plot.df$age<=35, ""Young"",ifelse(insurance.plot.df$age>=36 & insurance.plot.df$age<=55,""Senior"",""Elder""))"
"0",""
"0","insurance.plot.df$bmi_cat = ifelse(insurance.plot.df$bmi<18.5, ""Under Weight"", ifelse(insurance.plot.df$bmi>=18.5 & insurance.plot.df$bmi<24.9,""Normal Weight"",ifelse(insurance.plot.df$bmi>=25 & insurance.plot.df$bmi<29.9,""Overweight"",""Obese"")))"
"0",""
"0","neworder <- c(""Under Weight"",""Normal Weight"",""Overweight"",""Obese"")"
"0",""
"0","d1 <- arrange(mutate(insurance.plot.df,"
"0","             bmi_cat=factor(bmi_cat,levels=neworder)),bmi_cat)"
"0",""
"0","r4 = ggplot(d1, aes(x = bmi_cat, y = age_cat, z = fit)) + geom_raster(aes(fill = fit)) +"
"0","coord_fixed() + scale_fill_distiller(palette = ""RdYlBu"")  + labs(subtitle=""Female:Non-Smoker"",x="""",y="""")"
"0","r4"
