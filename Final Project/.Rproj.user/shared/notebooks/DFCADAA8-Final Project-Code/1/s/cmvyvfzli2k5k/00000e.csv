"0","library(ggpubr)"
"0",""
"0","neworder <- c(""Under Weight"",""Normal Weight"",""Overweight"",""Obese"")"
"0",""
"0","d1 <- arrange(mutate(insurance,"
"0","             bmi_cat=factor(bmi_cat,levels=neworder)),bmi_cat)"
"0",""
"0","d1 = d1 %>% group_by(bmi_cat,age_cat,region) %>% summarise(Mean = mean(charges))"
"0",""
"0","d2 = d1[d1$region==""northeast"",]"
"0",""
"0",""
"0",""
"0","ne = ggplot(d2, aes(x = bmi_cat, y = log10(Mean))) + "
"0","  labs(title = ""Northeast Region"") + "
"0","  geom_line(data = d2, aes(x = bmi_cat, y = log10(Mean), group = age_cat, color = age_cat)) + geom_point(data = d2, aes(x = bmi_cat, y = log10(Mean), group = age_cat, color = age_cat)) + "
"0","  theme(plot.title = element_text(hjust = 0.5), axis.title.x=element_blank(), axis.title.y=element_blank(), text = element_text(size=9)) + scale_color_manual(name=""Age Categories"",values=cb_palette)"
"0",""
"0",""
"0","d2 = d1[d1$region==""northwest"",]"
"0",""
"0",""
"0",""
"0","nw = ggplot(d2, aes(x = bmi_cat, y = log10(Mean))) + "
"0","  labs(title = ""Northwest Region"") + "
"0","  geom_line(data = d2, aes(x = bmi_cat, y = log10(Mean), group = age_cat, color = age_cat)) + geom_point(data = d2, aes(x = bmi_cat, y = log10(Mean), group = age_cat, color = age_cat)) + "
"0","  theme(plot.title = element_text(hjust = 0.5), axis.title.x=element_blank(), axis.title.y=element_blank(), text = element_text(size=9)) + scale_color_manual(name=""Age Categories"",values=cb_palette)"
"0",""
"0",""
"0","d2 = d1[d1$region==""southeast"",]"
"0",""
"0",""
"0",""
"0","se = ggplot(d2, aes(x = bmi_cat, y = log10(Mean))) + "
"0","  labs(title = ""Southeast Region"") + "
"0","  geom_line(data = d2, aes(x = bmi_cat, y = log10(Mean), group = age_cat, color = age_cat)) + geom_point(data = d2, aes(x = bmi_cat, y = log10(Mean), group = age_cat, color = age_cat)) + "
"0","  theme(plot.title = element_text(hjust = 0.5), axis.title.x=element_blank(), axis.title.y=element_blank(), text = element_text(size=9)) + scale_color_manual(name=""Age Categories"",values=cb_palette)"
"0",""
"0",""
"0","d2 = d1[d1$region==""southwest"",]"
"0",""
"0",""
"0",""
"0","sw = ggplot(d2, aes(x = bmi_cat, y = log10(Mean))) + "
"0","  labs(title = ""Southwest Region"") + "
"0","  geom_line(data = d2, aes(x = bmi_cat, y = log10(Mean), group = age_cat, color = age_cat)) + geom_point(data = d2, aes(x = bmi_cat, y = log10(Mean), group = age_cat, color = age_cat)) + "
"0","  theme(plot.title = element_text(hjust = 0.5), axis.title.x=element_blank(), axis.title.y=element_blank(), text = element_text(size=9)) + scale_color_manual(name=""Age Categories"",values=cb_palette)"
"0",""
"0",""
"0","gg_a = ggarrange(ne, nw, se, sw,common.legend=T,legend=""bottom"",ncol = 2,nrow=2)"
"0",""
"0",""
"0","ggpubr::annotate_figure(gg_a,top=""Average Medical Charges (Logged) v/s BMI \n Across different regions"",left=""Log 10 of Average Medical Charges"")"
"0",""
